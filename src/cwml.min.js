const cwml={is_initialized:!1,init:function(){var cwmlStyle=document.createElement("style");cwmlStyle.id="cwml-style",document.getElementsByTagName("head")[0].appendChild(cwmlStyle),this.is_initialized=!0},tags:{},registerTag:function($tag,$attrs={},$events={},$props={},$content=""){this.is_initialized||this.init(),window.customElements.define($tag.toLowerCase(),class CwmlTag extends HTMLElement{attrs={};events={};content="";initialInner="";constructor(){for(var event_name in super(),this.attrs=$attrs,this.events=$events,this.content=$content,this.initialInner=this.innerHTML,this.events){var event_func=this.events[event_name];event_name.startsWith("__")||this.addEventListener(event_name,(function(e){event_func(e.target)}))}if(""!=this.content){let _content=this.content.replaceAll("{inner}",this.initialInner);if(this.hasAttributes())for(var attr in this.attributes)_content=_content.replaceAll("{"+this.attributes[attr].name+"}",this.attributes[attr].textContent);this.innerHTML=_content}}connectedCallback(){void 0!==this.events.__added__&&this.events.__added__(this)}disconnectedCallback(){void 0!==this.events.__removed__&&this.events.__removed__(this)}adoptedCallback(){void 0!==this.events.__adopted__&&this.events.__adopted__(this)}static get observedAttributes(){let observed=[];return $attrs.constructor==Array?observed=$attrs:$attrs.constructor==Object&&(observed=Object.keys($attrs)),observed.push("cwml-dynamic"),observed}attributeChangedCallback(attrName,oldVal,newVal){if(this.attrs.constructor==Object&&void 0!==this.attrs[attrName]&&this.attrs[attrName](this,oldVal,newVal),!this.hasAttribute("cwml-dynamic")||"false"==this.attributes["cwml-dynamic"]){let _content=this.content.replaceAll("{inner}",this.initialInner);for(var attr in this.attributes)_content=_content.replaceAll("{"+this.attributes[attr].name+"}",this.attributes[attr].value);this.innerHTML=_content}}});var css=Object.keys($props).map((function(prop){return`${prop}: ${$props[prop]};`})).join("");css+=css.includes("display:")?"":"display: block;",document.getElementById("cwml-style").innerText+=`${$tag} {${css}}\n`,this.tags[$tag]={attributes:Object.keys($attrs),events:Object.keys($events),props:Object.keys($props),content:$content},void 0!==$events.__init__&&$events.__init__(this)},isTagSupported:function(tag){return void 0!==this.tags[tag]},attrs:{},registerAttr:function($query,$attr,$callback=function(el,newVal){}){var targets;this.is_initialized||this.init(),document.querySelectorAll($query).forEach(target=>{target.hasAttribute($attr)&&$callback(target,target.attributes[$attr].value),new MutationObserver((mutations,observer)=>{for(let mutation of mutations)"attributes"==mutation.type&&mutation.attributeName==$attr&&$callback(mutation.target,mutation.target.attributes[$attr].value)}).observe(target,{attributes:!0})}),this.attrs[$attr]={query:$query}},isAttrSupported:function(attr){return void 0!==this.attrs[attr]||(this.tags.forEach(tag=>{if(tag.attributes.includes(attr))return!0}),!1)}};
